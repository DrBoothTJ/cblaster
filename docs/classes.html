
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Classes &#8212; cblaster 1.0.5 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Context" href="context.html" />
    <link rel="prev" title="Usage" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-cblaster.classes">
<span id="classes"></span><h1>Classes<a class="headerlink" href="#module-cblaster.classes" title="Permalink to this headline">¶</a></h1>
<p>This module stores the classes (Organism, Scaffold, Hit) used in cblaster.</p>
<dl class="py class">
<dt id="cblaster.classes.Hit">
<em class="property">class </em><code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">Hit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query</span></em>, <em class="sig-param"><span class="n">subject</span></em>, <em class="sig-param"><span class="n">identity</span></em>, <em class="sig-param"><span class="n">coverage</span></em>, <em class="sig-param"><span class="n">evalue</span></em>, <em class="sig-param"><span class="n">bitscore</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">strand</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Hit" title="Permalink to this definition">¶</a></dt>
<dd><p>A BLAST hit.</p>
<p>Stores hit scores and genomic context. It is first instantiated when parsing BLAST
results, and is then updated with genomic coordinates after either querying the
NCBI’s IPG resource or a local JSON database.</p>
<dl class="py attribute">
<dt id="cblaster.classes.Hit.query">
<code class="sig-name descname">query</code><a class="headerlink" href="#cblaster.classes.Hit.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of query sequence</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.subject">
<code class="sig-name descname">subject</code><a class="headerlink" href="#cblaster.classes.Hit.subject" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of subject sequence</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.identity">
<code class="sig-name descname">identity</code><a class="headerlink" href="#cblaster.classes.Hit.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Hit identity (%)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.coverage">
<code class="sig-name descname">coverage</code><a class="headerlink" href="#cblaster.classes.Hit.coverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Hit query coverage (%)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.evalue">
<code class="sig-name descname">evalue</code><a class="headerlink" href="#cblaster.classes.Hit.evalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Hit e-value</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.bitscore">
<code class="sig-name descname">bitscore</code><a class="headerlink" href="#cblaster.classes.Hit.bitscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Hit bitscore</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.start">
<code class="sig-name descname">start</code><a class="headerlink" href="#cblaster.classes.Hit.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start of the subject sequence on its corresponding scaffold</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.end">
<code class="sig-name descname">end</code><a class="headerlink" href="#cblaster.classes.Hit.end" title="Permalink to this definition">¶</a></dt>
<dd><p>End of the subject sequence on its corresponding scaffold</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Hit.strand">
<code class="sig-name descname">strand</code><a class="headerlink" href="#cblaster.classes.Hit.strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Orientation of the subject sequence</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>“+” or “-“</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Hit.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Hit.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this Hit object with any additional args.</p>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Hit.values">
<code class="sig-name descname">values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decimals</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Hit.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Format all attributes of this hit for printing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>decimals</strong> (<em>int</em>) – Maximum number of decimal points to report. Note that this applies to
rounding, not necessarily display; i.e. if the attribute is 50 and
decimals=4, this function will return ‘50’, not ‘50.0000’. The e-value is
also capped using this parameter, but using exponent formatting.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>All attributes of this Hit, formatted as str.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cblaster.classes.Organism">
<em class="property">class </em><code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">Organism</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">strain</span></em>, <em class="sig-param"><span class="n">scaffolds</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Organism" title="Permalink to this definition">¶</a></dt>
<dd><p>An organism.</p>
<p>This class is used to represent a unique organism found during a cblaster search.
Every strain (or lack thereof) is counted as being unique, and will be reported
separately in <cite>cblaster</cite> results.</p>
<dl class="py attribute">
<dt id="cblaster.classes.Organism.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#cblaster.classes.Organism.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of this organism, generally the genus and species epithet. Sometimes, NCBI
stores the strain name inside the name field, in which case some basic filtering
is performed to remove it (i.e. if <cite>cblaster</cite> detects an exact match, it will be
removed).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Organism.strain">
<code class="sig-name descname">strain</code><a class="headerlink" href="#cblaster.classes.Organism.strain" title="Permalink to this definition">¶</a></dt>
<dd><p>Strain name of this organism. A unique <cite>Organism</cite> object is created for every
unique strain name encountered during the genomic context stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Organism.scaffolds">
<code class="sig-name descname">scaffolds</code><a class="headerlink" href="#cblaster.classes.Organism.scaffolds" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of <cite>Scaffold</cite> objects containing <cite>Hit</cite> objects belonging to this
organism.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Organism.count_hit_clusters">
<code class="sig-name descname">count_hit_clusters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Organism.count_hit_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Count total amount of hit clusters in this Organism.</p>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Organism.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">decimals</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">human</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">headers</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Organism.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a report of all hit clusters in this Organism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decimals</strong> (<em>int</em>) – How many decimal places to report score values</p></li>
<li><p><strong>human</strong> (<em>bool</em>) – Generate in human-readable format</p></li>
<li><p><strong>headers</strong> (<em>bool</em>) – Show column headers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>report</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cblaster.classes.Scaffold">
<em class="property">class </em><code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">Scaffold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">accession</span></em>, <em class="sig-param"><span class="n">clusters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Scaffold" title="Permalink to this definition">¶</a></dt>
<dd><p>A genomic scaffold.</p>
<p>This class represents a genomic scaffold belonging to an <cite>Organism</cite> object found
during a <cite>cblaster</cite> search.</p>
<dl class="py attribute">
<dt id="cblaster.classes.Scaffold.accession">
<code class="sig-name descname">accession</code><a class="headerlink" href="#cblaster.classes.Scaffold.accession" title="Permalink to this definition">¶</a></dt>
<dd><p>NCBI accession of this scaffold; otherwise, whatever a scaffold is named in
files used to generate a local database using <cite>cblaster makedb</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Scaffold.hits">
<code class="sig-name descname">hits</code><a class="headerlink" href="#cblaster.classes.Scaffold.hits" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>Hit</cite> objects located on this scaffold</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Scaffold.clusters">
<code class="sig-name descname">clusters</code><a class="headerlink" href="#cblaster.classes.Scaffold.clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Computed clusters of <cite>Hit</cite> objects on this scaffold</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Scaffold.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">human</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_header</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">decimals</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Scaffold.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a summary of hit clusters on this Scaffold.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cblaster.classes.Serializer">
<em class="property">class </em><code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">Serializer</code><a class="headerlink" href="#cblaster.classes.Serializer" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON serialisation mixin class.</p>
<p>Classes that inherit from this class should implement <cite>to_dict</cite> and
<cite>from_dict</cite> methods.</p>
<dl class="py method">
<dt id="cblaster.classes.Serializer.from_json">
<em class="property">classmethod </em><code class="sig-name descname">from_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">js</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Serializer.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate class from JSON handle.</p>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Serializer.to_json">
<code class="sig-name descname">to_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Serializer.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialise class to JSON.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cblaster.classes.Session">
<em class="property">class </em><code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">Session</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">queries</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">organisms</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>A search session.</p>
<p>This class is used to manage state during a cblaster search. It stores IDs of query
proteins, parameters used, RID if <cite>–remote</cite> and all Organism objects created during
the genomic context stage. Methods for generating summary tables and matrices for
plotting are also stored in this class.</p>
<p>Session objects can be dumped to/loaded from JSON to facilitate re-filtering/plotting.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;session.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">s</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;session.json&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">s2</span> <span class="o">=</span> <span class="n">Session</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">==</span> <span class="n">s2</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="cblaster.classes.Session.queries">
<code class="sig-name descname">queries</code><a class="headerlink" href="#cblaster.classes.Session.queries" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of query sequences</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Session.params">
<code class="sig-name descname">params</code><a class="headerlink" href="#cblaster.classes.Session.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of search parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cblaster.classes.Session.organisms">
<code class="sig-name descname">organisms</code><a class="headerlink" href="#cblaster.classes.Session.organisms" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>Organism</cite> objects found during a <cite>cblaster</cite> search</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Session.count_query_hits">
<code class="sig-name descname">count_query_hits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hits</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Session.count_query_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Count total hits per query in a colllection of <cite>Hit</cite> objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;query1&quot;</span><span class="p">,</span> <span class="s2">&quot;query2&quot;</span><span class="p">,</span> <span class="s2">&quot;query3&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hits</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">Hit</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;query1&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Hit</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;query2&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Hit</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;some_other_query&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">count_query_hits</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span>
<span class="go">[1, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Session.form_matrices">
<code class="sig-name descname">form_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">html</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Session.form_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Form 2D count matrices required for plotting.</p>
<p>If <cite>html</cite> is False, generated dendrogram leaves will contain LaTeX formatting.</p>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Session.format">
<code class="sig-name descname">format</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">form</span></em>, <em class="sig-param"><span class="n">fp</span></em>, <em class="sig-param"><span class="n">human</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">headers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Session.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate summary tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>form</strong> (<em>str</em>) – Type of table to generate (‘summary’ or ‘binary’)</p></li>
<li><p><strong>fp</strong> (<em>file handle</em>) – Handle table will be written to</p></li>
<li><p><strong>human</strong> (<em>bool</em>) – Generate table in human-readable format</p></li>
<li><p><strong>headers</strong> (<em>bool</em>) – Show table headers</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – <cite>form</cite> not ‘summary’ or ‘binary’</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Generated table</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cblaster.classes.Session.get_max_hit_identities">
<code class="sig-name descname">get_max_hit_identities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hits</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.Session.get_max_hit_identities" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the maximum hit identity per query in a collection of <cite>Hit</cite> objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;query1&quot;</span><span class="p">,</span> <span class="s2">&quot;query2&quot;</span><span class="p">,</span> <span class="s2">&quot;query3&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hits</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">Hit</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;query1&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Hit</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;query2&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Hit</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;query2&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_max_hit_identities</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span>
<span class="go">[0.9, 0.7, 0]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="cblaster.classes.generate_cluster_table">
<code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">generate_cluster_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hits</span></em>, <em class="sig-param"><span class="n">decimals</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">show_headers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">human</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.generate_cluster_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a summary table for a hit cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hits</strong> (<em>list</em>) – Collection of Hit instances</p></li>
<li><p><strong>decimals</strong> (<em>int</em>) – How many decimal points to show</p></li>
<li><p><strong>show_headers</strong> (<em>bool</em>) – Show column headers in output</p></li>
<li><p><strong>human</strong> (<em>bool</em>) – Generate human readable, not delimited, table</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Summary table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cblaster.classes.generate_header_string">
<code class="sig-prename descclassname">cblaster.classes.</code><code class="sig-name descname">generate_header_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">symbol</span><span class="o">=</span><span class="default_value">'-'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.classes.generate_header_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an underlined header string.</p>
<p>The underline is the specified symbol repeated for the length of the text.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="n">generate_header_string</span><span class="p">(</span><span class="s2">&quot;header string&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<span class="go">header string</span>
<span class="go">*************</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>str</em>) – Text to use in header</p></li>
<li><p><strong>symbol</strong> (<em>str</em>) – Character to use for divider</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Header string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">cblaster</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="genbank.html">GenBank</a></li>
<li class="toctree-l1"><a class="reference internal" href="helpers.html">Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="local.html">Local</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">Main</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote.html">Remote</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage</a></li>
      <li>Next: <a href="context.html" title="next chapter">Context</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Cameron Gilchrist.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/classes.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>