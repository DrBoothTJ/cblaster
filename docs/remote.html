
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Remote &#8212; cblaster 1.0.5 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Main" href="main.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-cblaster.remote">
<span id="remote"></span><h1>Remote<a class="headerlink" href="#module-cblaster.remote" title="Permalink to this headline">¶</a></h1>
<p>This module handles all interaction with NCBI’s BLAST API, including launching new
remote searches, polling for completion status, and retrieval of results.</p>
<dl class="py function">
<dt id="cblaster.remote.check">
<code class="sig-prename descclassname">cblaster.remote.</code><code class="sig-name descname">check</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rid</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.remote.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check completion status of a BLAST search given a Request Identifier (RID).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>True</em> – If search completed successfully and hits were reported</p></li>
<li><p><em>False</em> – Search is still being run</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the search has failed. This can be caused either by program error (whereby
    NCBI requests you submit an error report with the RID) or expiration of the RID
    (only stored for 24 hours).</p></li>
<li><p><strong>ValueError</strong> – Search has completed successfully, but no hits were reported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cblaster.remote.parse">
<code class="sig-prename descclassname">cblaster.remote.</code><code class="sig-name descname">parse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">query_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">query_ids</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_evalue</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">min_identity</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">min_coverage</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.remote.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse Tabular results from remote BLAST search performed via API.</p>
<p>Since the API provides no option for returning query coverage, which is a metric we
want to use for filtering hits, query sequences must be passed to this function so
that their lengths can be compared to the alignment length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> (<em>open file handle</em>) – File handle (or file handle-like) object corresponding to BLAST results. Note
that this function expects an iterable of tab-delimited lines and performs no
validation/error checking</p></li>
<li><p><strong>query_file</strong> (<em>str</em>) – Path to query file</p></li>
<li><p><strong>query_ids</strong> (<em>list</em><em>, </em><em>tuple</em>) – Collection of NCBI sequence identifiers</p></li>
<li><p><strong>max_evalue</strong> (<em>float</em>) – Maximum e-value</p></li>
<li><p><strong>min_identity</strong> (<em>float</em>) – Minimum percent identity</p></li>
<li><p><strong>min_coverage</strong> (<em>float</em>) – Minimum percent query coverage</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of Hit instances corresponding to criteria passing BLAST hits</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cblaster.remote.poll">
<code class="sig-prename descclassname">cblaster.remote.</code><code class="sig-name descname">poll</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rid</span></em>, <em class="sig-param"><span class="n">delay</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">max_retries</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.remote.poll" title="Permalink to this definition">¶</a></dt>
<dd><p>Poll BLAST API with given Request Identifier (RID) until results are returned.</p>
<p>As per NCBI usage guidelines, this function will only poll once per minute; this is
calculated each time such that wait is constant (i.e. accounts for differing
response time on the status check).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Output of retrieve()</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cblaster.remote.retrieve">
<code class="sig-prename descclassname">cblaster.remote.</code><code class="sig-name descname">retrieve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rid</span></em>, <em class="sig-param"><span class="n">hitlist_size</span><span class="o">=</span><span class="default_value">500</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.remote.retrieve" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve BLAST results corresponding to a given Request Identifier (RID).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List containing BLAST search results, with non-TSV elements (HTML, #info lines)
removed. Each element in the returned list corresponds to one row in the BLAST
table (still need to be split by tab).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cblaster.remote.search">
<code class="sig-prename descclassname">cblaster.remote.</code><code class="sig-name descname">search</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">query_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">query_ids</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_identity</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">min_coverage</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">max_evalue</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.remote.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a remote BLAST search via the NCBI’s BLAST API.</p>
<p>This function launches a new search given a query FASTA file or list of valid NCBI
identifiers, polls the API to check the completion status of the search, then
retrieves and parses the results.</p>
<p>It is also possible to call other BLAST variants using the <cite>program</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rid</strong> (<em>str</em>) – Request Identifier (RID) of a web BLAST search</p></li>
<li><p><strong>query_file</strong> (<em>str</em>) – Path to query FASTA file</p></li>
<li><p><strong>query_ids</strong> (<em>list</em><em>, </em><em>tuple</em>) – Collection of NCBI sequence identifiers</p></li>
<li><p><strong>min_identity</strong> (<em>float</em>) – Minimum percent identity</p></li>
<li><p><strong>min_coverage</strong> (<em>float</em>) – Minimum percent query coverage</p></li>
<li><p><strong>max_evalue</strong> (<em>float</em>) – Maximum e-value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of Organism instances, containing Scaffold instances that store Hits and
clusters of Hits.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cblaster.remote.start">
<code class="sig-prename descclassname">cblaster.remote.</code><code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">query_ids</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">database</span><span class="o">=</span><span class="default_value">'nr'</span></em>, <em class="sig-param"><span class="n">program</span><span class="o">=</span><span class="default_value">'blastp'</span></em>, <em class="sig-param"><span class="n">megablast</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filtering</span><span class="o">=</span><span class="default_value">'F'</span></em>, <em class="sig-param"><span class="n">evalue</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">nucl_reward</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nucl_penalty</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gap_costs</span><span class="o">=</span><span class="default_value">'11 1'</span></em>, <em class="sig-param"><span class="n">matrix</span><span class="o">=</span><span class="default_value">'BLOSUM62'</span></em>, <em class="sig-param"><span class="n">hitlist_size</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">word_size</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">comp_based_stats</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">entrez_query</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#cblaster.remote.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Launch a remote BLAST search using NCBI BLAST API.</p>
<p>Note that the HITLIST_SIZE, ALIGNMENTS and DESCRIPTIONS parameters must all be set
together in order to mimic ‘max_target_seqs’ behaviour.</p>
<p>Usage guidelines:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Don’t contact server more than once every 10 seconds</p></li>
<li><p>Don’t poll for a single RID more than once a minute</p></li>
<li><p>Use URL parameter email/tool</p></li>
<li><p>Run scripts weekends or 9pm-5am Eastern time on weekdays if &gt;50 searches</p></li>
</ol>
</div></blockquote>
<p>For a full description of the parameters, see:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><cite>BLAST API documentation&lt;https://ncbi.github.io/blast-cloud/dev/api.html&gt;</cite></p></li>
</ol>
<p>2. <cite>BLAST documentation
&lt;https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastDocs&amp;DOC_TYPE=BlastHelp&gt;</cite></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_file</strong> (<em>str</em>) – Path to a query FASTA file</p></li>
<li><p><strong>query_ids</strong> (<em>list</em><em>, </em><em>tuple</em>) – Collection of NCBI sequence identifiers</p></li>
<li><p><strong>database</strong> (<em>str</em>) – Target NCBI BLAST database</p></li>
<li><p><strong>program</strong> (<em>str</em>) – BLAST variant to run</p></li>
<li><p><strong>megablast</strong> (<em>bool</em>) – Enable megaBLAST option (only with BLASTn)</p></li>
<li><p><strong>filtering</strong> (<em>str</em>) – Low complexity filtering</p></li>
<li><p><strong>evalue</strong> (<em>float</em>) – E-value cutoff</p></li>
<li><p><strong>nucl_reward</strong> (<em>int</em>) – Reward for matching bases (only with BLASTN/megaBLAST)</p></li>
<li><p><strong>nucl_penalty</strong> (<em>int</em>) – Penalty for mismatched bases (only with BLASTN/megaBLAST)</p></li>
<li><p><strong>gap_costs</strong> (<em>str</em>) – Gap existence and extension costs</p></li>
<li><p><strong>matrix</strong> (<em>str</em>) – Scoring matrix name</p></li>
<li><p><strong>hitlist_size</strong> (<em>int</em>) – Number of database sequences to keep</p></li>
<li><p><strong>threshold</strong> (<em>int</em>) – Neighbouring score for initial words</p></li>
<li><p><strong>word_size</strong> (<em>int</em>) – Size of word for initial matches</p></li>
<li><p><strong>comp_based_stats</strong> (<em>int</em>) – Composition based statistics algorithm</p></li>
<li><p><strong>entrez_query</strong> (<em>str</em>) – NCBI Entrez search term for pre-filtering the BLAST database</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rid</strong> (<em>str</em>) – Request Identifier (RID) assigned to the search</p></li>
<li><p><strong>rtoe</strong> (<em>int</em>) – Request Time Of Execution (RTOE), estimated run time (in seconds) of the search</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">cblaster</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="genbank.html">GenBank</a></li>
<li class="toctree-l1"><a class="reference internal" href="helpers.html">Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="local.html">Local</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">Main</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Remote</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="main.html" title="previous chapter">Main</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Cameron Gilchrist.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/remote.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>